#Utilizaremos el método de mínimos cuadrados para encontrar el polinomio de grado 7 que mejor modele los precios del petróleo, plata y oro respectivamente, de igual manera a cómo se realizó en el punto 2#

A1=[1 1 1 1 1 1 1 1;3^7 3^6 243 81 27 9 3 1;4^7 4^6 1024 256 64 16 4 1;5^7 5^6 3125 625 125 25 5 1;6^7 6^6 7776 1236 216 36 6 1;7^7 7^6 16087 2401 343 49 7 1;8^7 8^6 32768 4096 512 64 8 1;11^7 11^6 11^5 11^4 11^3 11^2 11 1;12^7 12^6 12^5 12^4 12^3 12^2 12 1;13^7 13^6 13^5 13^4 13^3 13^2 13 1;14^7 14^6 14^5 14^4 14^3 14^2 14 1;15^7 15^6 15^5 15^4 15^3 15^2 15 1;18^7 18^6 18^5 18^4 18^3 18^2 18 1;19^7 19^6 19^5 19^4 19^3 19^2 19 1;20^7 20^6 20^5 20^4 20^3 20^2 20 1;21^7 21^6 21^5 21^4 21^3 21^2 21 1;22^7 22^6 22^5 22^4 22^3 22^2 22 1;25^7 25^6 25^5 25^4 25^3 25^2 25 1]

b1=[91.07;91.62;92.65;92.35;92.10;92.81;91.59;95.72;103.41;110.60;107.67;115.68;119.40;123.70;108.70;106.02;109.33;103.01]

x1 = transpose(A1)*A1 \ transpose(A1)*b1

import Pkg; Pkg.add("Plots")
using Plots


f(x)=(6.013171810586607*10^-14)*x^7+(1.2040776286236586*10^-5)*x^6-(0.0006477282480684028)*x^5+(0.009364631356165859)*x^4+(0.010763417486848503)*x^3-(0.8429326297888657)*x^2+4.097097475043853*x+87.3501118318426
plot(f,1,25) #Ajuste del precio del petróleo#

A2=[1 1 1 1 1 1 1 1;4^7 4^6 1024 256 64 16 4 1;5^7 5^6 3125 625 125 25 5 1;6^7 6^6 7776 1236 216 36 6 1;7^7 7^6 16087 2401 343 49 7 1;8^7 8^6 32768 4096 512 64 8 1;11^7 11^6 11^5 11^4 11^3 11^2 11 1;12^7 12^6 12^5 12^4 12^3 12^2 12 1;13^7 13^6 13^5 13^4 13^3 13^2 13 1;14^7 14^6 14^5 14^4 14^3 14^2 14 1;15^7 15^6 15^5 15^4 15^3 15^2 15 1;18^7 18^6 18^5 18^4 18^3 18^2 18 1;19^7 19^6 19^5 19^4 19^3 19^2 19 1;20^7 20^6 20^5 20^4 20^3 20^2 20 1;21^7 21^6 21^5 21^4 21^3 21^2 21 1;22^7 22^6 22^5 22^4 22^3 22^2 22 1;25^7 25^6 25^5 25^4 25^3 25^2 25 1]

b2=[23.93;24.02;24.14;24.56;24.20;24.30;24.46;25.45;25.33;25.21;25.86;25.86;26.94;25.97;26.24;26.20;25.34]

x2 = transpose(A2)*A2 \ transpose(A2)*b2

f(x)=-(1.5884767322285915*10^-14)*x^7-(5.031801543712388*10^-7)*x^6+(4.417542835740665*10^-5)*x^5-(0.0015393835337490676)*x^4+(0.025594964495466804)*x^3-(0.19457718332342555)*x^2+0.6552246708375287*x+23.40853846616888
plot(f,1,25)#Ajuste del precio de la plata#

A=[1 1 1 1 1 1 1 1;2^7 2^6 32 16 8 4 2 1;3^7 3^6 243 81 27 9 3 1;4^7 4^6 1024 256 64 16 4 1;5^7 5^6 3125 625 125 25 5 1;6^7 6^6 7776 1236 216 36 6 1;7^7 7^6 16087 2401 343 49 7 1;8^7 8^6 32768 4096 512 64 8 1;9^7 9^6 59049 6561 729 81 9 1;10^7 10^6 100000 10000 1000 100 10 1;11^7 11^6 11^5 11^4 11^3 11^2 11 1;12^7 12^6 12^5 12^4 12^3 12^2 12 1;13^7 13^6 13^5 13^4 13^3 13^2 13 1;14^7 14^6 14^5 14^4 14^3 14^2 14 1;15^7 15^6 15^5 15^4 15^3 15^2 15 1; 16^7 16^6 16^5 16^4 16^3 16^2 16 1;17^7 17^6 17^5 17^4 17^3 17^2 17 1;18^7 18^6 18^5 18^4 18^3 18^2 18 1;19^7 19^6 19^5 19^4 19^3 19^2 19 1;20^7 20^6 20^5 20^4 20^3 20^2 20 1;21^7 21^6 21^5 21^4 21^3 21^2 21 1;22^7 22^6 22^5 22^4 22^3 22^2 22 1;23^7 23^6 23^5 23^4 23^3 23^2 23 1;24^7 24^6 24^5 24^4 24^3 24^2 24 1;25^7 25^6 25^5 25^4 25^3 25^2 25 1]

b3=[1898.52;1898.43;1904.92;1909.54;1898.33;1910.85;1906.46;1889.40;1889.40;1910.29;1906.45;1942.39;1928.97;1934.89;1970.73;1970.73;1988.50;1998.72;2043.94;1989.96;1995.41;1998.50;1988.50;1974.31;1952.19]

x3 = transpose(A)*A \ transpose(A)*b3

f(x)=-(1.3097970754903823*10^-13)*x^7+(2.0958812691737215*10^-5)*x^6-(0.001190286440444402)*x^5+(0.014963618677451773)*x^4+(0.1716102511675217)*x^3-(3.859414321372242)*x^2+18.694112166673904*x+1879.940950540848
plot(f,1,25)# Ajuste del precio del oro#

f(x)=(6.885823984708308*10^-11)*x^7+0.009233968957349438*x^6-0.6819245696922893*x^5+18.41227043495529*x^4-215.84381582703816*x^3+956.1373535094963*x^2-162.90296646956995*x+36599.98158571445
plot(f,1,25) #Ajuste del precio del bitcoin#

#Si comparamos las tres gráficas, podemos ver que los precios tanto del bitcoin como de las tres commodities muestran una tendencia ascendente durante los últimos 25 días.
#En particular, el precio de las tres commodities alcanza un pico máximo durante los días 15-20 aproximadamente para luego empezar a descender, este pico también coincide con uno de los dos picos del precio del bitcoin,
#con lo cual podemos concluir que dichos 4 precios están correlacionados positivamente(el incremento en el precio de uno está relacionado en el incremento en los precios del resto) 
